create database movie
use movie
CREATE TABLE ACTOR
(
ACT_ID INT PRIMARY KEY,
ACT_NAME varchar(30),
ACT_GENDER CHAR(1) 
);

CREATE TABLE DIRECTOR
(
DIR_ID INT PRIMARY KEY,
DIR_NAME VARCHAR(25),
dir_phone INT
);

CREATE TABLE MOVIES
(
MOV_ID INT PRIMARY KEY,
MOV_TITLE VARCHAR(50),
MOV_YEAR date,
MOV_LANG VARCHAR(20),
DIR_ID INT REFERENCES DIRECTOR(DIR_ID),

);


CREATE TABLE MOVIE_CAST(
ACT_ID INT REFERENCES ACTOR(ACT_ID),
MOV_ID INT REFERENCES MOVIES(MOV_ID),
ROLE VARCHAR(20),
PRIMARY KEY(ACT_ID,MOV_ID)
);

CREATE TABLE VIEWER(
VIEW_ID INT PRIMARY KEY,
VIEW_NAME VARCHAR(25),
AGE INT,
VIEW_GENDER char(1) 
);

CREATE TABLE RATINGS(
VIEW_ID INT REFERENCES VIEWER(VIEW_ID),
MOV_ID INT REFERENCES MOVIES(MOV_ID),
STARS INT 
PRIMARY KEY(VIEW_ID,MOV_ID),
);
INSERT INTO ACTOR VALUES (101,'SHAHID KAPOOR','M')
INSERT INTO ACTOR VALUES (102,'ANUSHKA SHARMA','F')

INSERT INTO ACTOR VALUES (103,'RANBIR KAPOOR','M')
INSERT INTO ACTOR VALUES (104,'ALIA BHAT','F')
INSERT INTO ACTOR VALUES (105,'PARINITHI CHOPRA','F')
INSERT INTO ACTOR VALUES (106,'VARUN DHAVAN','M')
SELECT *FROM ACTOR

INSERT INTO DIRECTOR VALUES (1001,'AAAA',93876259)
INSERT INTO DIRECTOR VALUES (1002,'BBBB',83761947)
INSERT INTO DIRECTOR VALUES (1003,'CCCC',85679026)
INSERT INTO DIRECTOR VALUES (1004,'DDDD',97254689)
INSERT INTO DIRECTOR VALUES (1005,'EEEE',84732648)
SELECT *FROM DIRECTOR
INSERT INTO MOVIES VALUES (1,'JAB WE MET','11-30-2007','HINDI',1001)
INSERT INTO MOVIES VALUES (2,'PK','12-13-2014','ENGLISH',1004)
INSERT INTO MOVIES VALUES (3,'YEH JAWANI HAI DIWANI','3-14-2013','KANNADA',1005)
INSERT INTO MOVIES VALUES (4,'STUDENT OF THE YEAR','2-15-2012','HINDI',1003)
INSERT INTO MOVIES VALUES (5,'ISHAQZAADE','12-14-2012','HINDI',1001)

SELECT *FROM MOVIES
INSERT INTO MOVIE_CAST VALUES (101,1,'HERO')
INSERT INTO MOVIE_CAST VALUES (102,2,'HEROINE')
INSERT INTO MOVIE_CAST VALUES (103,3,'HERO')
INSERT INTO MOVIE_CAST VALUES (104,4,'HEROINE')
INSERT INTO MOVIE_CAST VALUES (105,5,'HEROINE')
SELECT *FROM MOVIE_CAST
INSERT INTO VIEWER VALUES (1,'ZZZZ',22,'M')
INSERT INTO VIEWER VALUES (2,'YYYY',24,'F')
INSERT INTO VIEWER VALUES (3,'XXXX',24,'M')
INSERT INTO VIEWER VALUES (4,'WWWW',38,'M')
INSERT INTO VIEWER VALUES (5,'NNNN',20,'F')
INSERT INTO VIEWER VALUES (6,'SSSS',20,'M')
INSERT INTO VIEWER VALUES (7,'UUUU',20,'F')
INSERT INTO VIEWER VALUES (8,'VVVV',20,'M')
INSERT INTO RATINGS VALUES (1,3,5)
INSERT INTO RATINGS VALUES (1,5,4)
INSERT INTO RATINGS VALUES (2,6,5)
INSERT INTO RATINGS VALUES (3,4,4)
INSERT INTO RATINGS VALUES (3,5,4)
INSERT INTO RATINGS VALUES (4,2,4)
INSERT INTO RATINGS VALUES (5,1,5)
INSERT INTO RATINGS VALUES (6,1,5)
SELECT *FROM RATINGS
/*List all actors who acted in a movie before 2000 and also in a movie after 2017.*/
SELECT A.ACT_NAME FROM ACTOR A,MOVIE_CAST MC,MOVIES M WHERE A.ACT_ID=MC.ACT_ID AND MC.MOV_ID=M.MOV_ID AND MOV_YEAR<2012
INTERSECT
SELECT A.ACT_NAME FROM ACTOR A,MOVIE_CAST MC,MOVIES M WHERE A.ACT_ID=MC.ACT_ID AND MC.MOV_ID=M.MOV_ID AND MOV_YEAR>2017
/*Update rating of all movies directed by ‘Subhash Ghai’ to 5.*/
SELECT M.MOV_TITLE,MAX(R.STARS) AS RATINGS FROM MOVIES M,RATINGS R WHERE M.MOV_ID=R.MOV_ID AND R.STARS>1 GROUP BY M.MOV_TITLE
/*Find the title of movies and number of stars for each movie that has at least one ratinand find the highest number of stars that movie received. Sort the result by movietitle.*/
UPDATE RATINGS SET STARS=5 WHERE MOV_ID IN(SELECT M.MOV_ID FROM MOVIES M,DIRECTOR D WHERE M.DIR_ID=D.DIR_ID AND D.DIR_NAME='AAAA')
select m.mov_title,r.stars from RATINGS r,director d,movies m where d.DIR_ID=m.DIR_ID and r.mov_id=m.MOV_ID and d.DIR_NAME='AAAA'

SELECT D.DIR_NAME,R.STARS FROM RATINGS R,MOVIES M,DIRECTOR D WHERE STARS = 5 AND R.MOV_ID=M.MOV_ID AND D.DIR_ID=M.DIR_ID AND D.DIR_NAME='AAAA'